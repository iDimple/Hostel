<!DOCTYPE html>
<html>
<head>
<title>预订酒店</title>
<link href="css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/bootstrap-datetimepicker.js"></script>  
<script src="js/bootstrap-datetimepicker.fr.js"></script> 
<script src="js/moment.js"></script> 
<script src="js/scripts.js"></script>
<script src="js/distpicker.data.js"></script>
<script src="js/distpicker.js"></script>
<link href="css/styles.css" rel="stylesheet">
<link href="css/bootstrap-datetimepicker.min.css" rel="stylesheet">
<link href="css/style.css" rel="stylesheet" type="text/css" media="all" />	
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>

</head>
<body>

<!-- 模态框（Modal） -->
<div class="modal fade" id="book" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">酒店预订</h4>
            </div>
            <div class="modal-body">
            	<div class="form-info">
	            	<form method="post" id="book_form">
	            		<label style="font-size: 1.0em; color: black; font-family:'Microsoft YaHei';">房型选择</label>
	            		<div id="category" style="margin-left:-20px;">
							<label class="checkbox-inline">
								<input type="radio" name="category" id="optionsRadios1" value="0">单人房间
							</label>
							<label class="checkbox-inline">
						    	<input type="radio" name="category" id="optionsRadios2" value="1">标准房间
						    </label>
						    <label class="checkbox-inline">
						    	<input type="radio" name="category" id="optionsRadios3" value="2">高级套房
						    </label>
						</div>
						<p></p>
						<label style="font-size: 1.0em; color: black; font-family:'Microsoft YaHei';">日期选择</label>
		            	<div class="container">
						    <div class='col-md-3' style="margin-left:-20px; width:200px;">
						        <div class="form-group" style="margin-left:-20px; width:180px;">
						            <div class='input-group date' id='datetimepicker6' style="margin-left:0px;width:150px;">
						                <input type='text' class="form-control" id="startDate" name="start" style="margin-left:10px;"/>
						                <span class="input-group-addon" style="margin-left:0px;" ><span class="glyphicon glyphicon-calendar"></span>
						                </span>
						            </div>
						        </div>
						    </div>
						    <label style="margin-left:-270px; margin-top:12px;">-</label>
						    <div class='col-md-3' style="margin-left:70px;  width:200px;">
						        <div class="form-group" style="margin-left:-20px; width:180px;">
						            <div class='input-group date' id='datetimepicker7' style="margin-left:0px;width:150px;">
						                <input type='text' class="form-control" id="endDate" name="end" style="margin-left:10px;"/>
						                <span class="input-group-addon" style="margin-left:0px;"><span class="glyphicon glyphicon-calendar"></span>
						                </span>
						            </div>
						        </div>
						    </div>
						</div>
					    <div style="width:20%;margin:0 auto;text-align:middle;">
            				<label class="hvr-sweep-to-right">
				           		<input id="bookBtn" type="button" value="预订">
				    		</label>
				    	</div>
						<div id="infor"></div>
	            	</form>
            	</div>
            	
				<script type="text/javascript">
				    $(function () {
				        $('#datetimepicker6').datetimepicker({
		                	minView: "month", //选择日期后，不会再跳转去选择时分秒 
		                	format: "yyyy-mm-dd", //选择日期后，文本框显示的日期格式 
		                	autoclose:true //选择日期后自动关闭 
					        });
				        $('#datetimepicker7').datetimepicker({
		                	minView: "month", //选择日期后，不会再跳转去选择时分秒 
		                	format: "yyyy-mm-dd", //选择日期后，文本框显示的日期格式 
		                	autoclose:true //选择日期后自动关闭 
					        });
				        $("#datetimepicker6").on("dp.change",function (e) {
				            $('#datetimepicker7').data("DateTimePicker").minDate(e.date);
				        });
				        $("#datetimepicker7").on("dp.change",function (e) {
				            $('#datetimepicker6').data("DateTimePicker").maxDate(e.date);
				        });
				    });
				</script>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>
<!-- 模态框 -->

<!--header-->
	<div class="navigation">
			<div class="container-fluid">
				<nav class="pull">
					<ul>
						<li><a  href="/HostelWorld/home?id=0">主页</a></li>
						<li><a  href="about.html">关于我们</a></li>
						<li><a  href="/HostelWorld/home?id=5">个人页面</a></li>
					</ul>
				</nav>			
			</div>
		</div>

<div class="header">
	<div class="container">
		<!--logo-->
			<div class="logo">
				<h1><a href="index.html">客栈之家</a></h1>
			</div>
		<!--//logo-->
		<div class="top-nav">
			<ul class="right-icons">

				<li><a  href="http://localhost:8080/HostelWorld/logout"><i class="glyphicon glyphicon-user"> </i>注销</a></li>
				<li><a class="play-icon popup-with-zoom-anim" href="#small-dialog"><i class="glyphicon glyphicon-search"> </i> </a></li>
				
			</ul>
			<div class="nav-icon">
				<div class="hero fa-navicon fa-2x nav_slide_button" id="hero">
						<a href="#"><i class="glyphicon glyphicon-menu-hamburger"></i> </a>
					</div>	
				<!---
				<a href="#" class="right_bt" id="activator"><i class="glyphicon glyphicon-menu-hamburger"></i>  </a>
			--->
			</div>
		<div class="clearfix"> </div>
			<!---pop-up-box---->
				    
				<link href="css/popuo-box.css" rel="stylesheet" type="text/css" media="all"/>
				<script src="js/jquery.magnific-popup.js" type="text/javascript"></script>
			<!---//pop-up-box---->
				<div id="small-dialog" class="mfp-hide">
					    <!----- tabs-box ---->
				<div class="sap_tabs">	
				     <div id="horizontalTab" style="display: block; width: 100%; margin: 0px;">
						  <ul class="resp-tabs-list">
						  	  <li class="resp-tab-item " aria-controls="tab_item-0" role="tab"><span>All Homes</span></li>
							  <li class="resp-tab-item" aria-controls="tab_item-1" role="tab"><span>For Sale</span></li>
							  <li class="resp-tab-item" aria-controls="tab_item-2" role="tab"><span>For Rent</span></li>
							  <div class="clearfix"></div>
						  </ul>				  	 
						  <div class="resp-tabs-container">
						  		<h2 class="resp-accordion resp-tab-active" role="tab" aria-controls="tab_item-0"><span class="resp-arrow"></span>All Homes</h2><div class="tab-1 resp-tab-content resp-tab-content-active" aria-labelledby="tab_item-0" style="display:block">
								 	<div class="facts">
									  	<div class="login">
											<input type="text" value="Search Address, Neighborhood, City or Zip" onfocus="this.value = '';" onblur="if (this.value == '') {this.value = 'Search Address, Neighborhood, City or Zip';}">		
									 		<input type="submit" value="">
									 	</div>        
							        </div>
						  		</div>
							     <h2 class="resp-accordion" role="tab" aria-controls="tab_item-1"><span class="resp-arrow"></span>For Sale</h2><div class="tab-1 resp-tab-content" aria-labelledby="tab_item-1">
									<div class="facts">									
										<div class="login">
											<input type="text" value="Search Address, Neighborhood, City or Zip" onfocus="this.value = '';" onblur="if (this.value == '') {this.value = 'Search Address, Neighborhood, City or Zip';}">		
									 		<input type="submit" value="">
									 	</div> 
							        </div>	
								 </div>									
							      <h2 class="resp-accordion" role="tab" aria-controls="tab_item-2"><span class="resp-arrow"></span>For Rent</h2><div class="tab-1 resp-tab-content" aria-labelledby="tab_item-2">
									 <div class="facts">
										<div class="login">
											<input type="text" value="Search Address, Neighborhood, City or Zip" onfocus="this.value = '';" onblur="if (this.value == '') {this.value = 'Search Address, Neighborhood, City or Zip';}">		
									 		<input type="submit" value="">
									 	</div> 
							         </div>	
							    </div>
					      </div>
					 </div>
					 <script src="js/easyResponsiveTabs.js" type="text/javascript"></script>
				    	<script type="text/javascript">
						    $(document).ready(function () {
						        $('#horizontalTab').easyResponsiveTabs({
						            type: 'default', //Types: default, vertical, accordion           
						            width: 'auto', //auto or any width like 600px
						            fit: true   // 100% fit in a container
						        });
						    });
			  			 </script>	
				</div>
				</div>
				 <script>
						$(document).ready(function() {
						$('.popup-with-zoom-anim').magnificPopup({
							type: 'inline',
							fixedContentPos: false,
							fixedBgPos: true,
							overflowY: 'auto',
							closeBtnInside: true,
							preloader: false,
							midClick: true,
							removalDelay: 300,
							mainClass: 'my-mfp-zoom-in'
						});
																						
						});
				</script>
					
	
		</div>
		<div class="clearfix"> </div>
		</div>	
</div>
<!--//-->	
<div class=" banner-buying">
	<div class=" container">
	<h3><span>预订酒店</span></h3> 
	<!---->
	<div class="menu-right">
		 <ul class="menu">
			<li class="item1"><a href="#"> <span style="margin-right:10px;"></span>选项<i class="glyphicon glyphicon-menu-down"> </i> </a>
			<ul class="cute">
				<li class="subitem1"><a href="/HostelWorld/home?id=13">预订酒店 </a></li>
				<li class="subitem2"><a href="/HostelWorld/home?id=14">我的订单 </a></li>
				<li class="subitem3"><a href="/HostelWorld/home?id=3">我的会员卡</a></li>
			</ul>
		</li>
		</ul>
	</div>
	<div class="clearfix"> </div>
		<!--initiate accordion-->
		<script type="text/javascript">
			$(function() {
			    var menu_ul = $('.menu > li > ul'),
			           menu_a  = $('.menu > li > a');
			    menu_ul.hide();
			    menu_a.click(function(e) {
			        e.preventDefault();
			        if(!$(this).hasClass('active')) {
			            menu_a.removeClass('active');
			            menu_ul.filter(':visible').slideUp('normal');
			            $(this).addClass('active').next().stop(true,true).slideDown('normal');
			        } else {
			            $(this).removeClass('active');
			            $(this).next().stop(true,true).slideUp('normal');
			        }
			    });
			
			});
		</script>
      		
	</div>
</div>
<!--//header-->
<div class="contact">
	<div class="container">
		<h3>酒店查询</h3>
		<div class="price">
			<div class="price-grid">
				<form method="post" id="search_form">
						<div class="col-sm-8 price-top">
							<h4>预订地址</h4>
							<div id="distpicker1">
						   		<select style="color:rgb(111,111,111);border-color: rgb(238,238,238);" id="province" name="province"></select>
								<select style="color:rgb(111,111,111);border-color: rgb(238,238,238);" id="city" name="city"></select>
							</div>
					    </div>
					<div class="clearfix"> </div>
					<div class="col-sm-8 price-top" >
						<h4>预订日期</h4>
						<div class="container" style="width:100%;">
					        <div class="form-group">
					            <div class='input-group date' id='datetimepicker8'>
					                <input type='text' class="form-control" id="startDate" name="start"/>
					                <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span>
					                </span>
					            </div>
					        </div>
						</div>
					</div>
					<div class="clearfix"> </div>
					<input type="button" id="searchBtn" value="查询计划" class="btn btn-success" style="margin-left: 240px;">
					<div id="infor"></div>
				</form>
	
			</div>
		</div>
</div>	
<script type="text/javascript">
$("#distpicker1").distpicker({
	autoSelect:false
});


$(function () {
    $('#datetimepicker8').datetimepicker({
    	minView: "month", //选择日期后，不会再跳转去选择时分秒 
    	format: "yyyy-mm-dd", //选择日期后，文本框显示的日期格式 
    	autoclose:true //选择日期后自动关闭 
        });
});
</script>

<div class="top-grid" id="promotionPlanList"></div>
<div class="clearfix"> </div>
<div class="top-grid" id="ordinaryPlanList"></div>

	<!---->
	<div class="top-grid">
		<h3>热门城市</h3>
		<div class="grid-at">
			<div class="col-md-3 grid-city">
				<div class="grid-lo">
					<a href="buy_single.html">
						<figure class="effect-layla">
						<img class=" img-responsive" src="images/ce.jpg" alt="img06">
						<figcaption>
							<h4>伦敦</h4>
							
						</figcaption>			
					</figure>
					</a>
				 </div>
			</div>
			<div class="col-md-3 grid-city">
				<div class="grid-lo">
						<a href="buy_single.html">
					<figure class="effect-layla">
						<img class=" img-responsive" src="images/ce1.jpg" alt="img06">
						<figcaption>
							<h4>悉尼</h4>
							
						</figcaption>			
					</figure>
					</a>
				 </div>
			</div>
			<div class="col-md-6 grid-city grid-city1">
				<div class="grid-me">
				<div class="col-md-8 grid-lo1">
					<div class=" grid-lo">
							<a href="buy_single.html">
					<figure class="effect-layla">
						<img class=" img-responsive" src="images/ce2.jpg" alt="img06">
						<figcaption>
							<h4 class="effect1">纽约</h4>
							
						</figcaption>			
					</figure>
					</a>
				 </div>
				</div>
				 <div class="col-md-4 grid-lo2">
				 	<div class=" grid-lo">
				 			<a href="buy_single.html">
					<figure class="effect-layla">
						<img class=" img-responsive" src="images/ce3.jpg" alt="img06">
						<figcaption>
							<h4 class="effect2">罗马</h4>
							
						</figcaption>			
					</figure>
					</a>
				 </div>
				 </div>
				 <div class="clearfix"> </div>
			</div>	
			<div class="grid-me">
				<div class="col-md-6 grid-lo3">
					<div class=" grid-lo">
							<a href="buy_single.html">
					<figure class="effect-layla">
						<img class="img-responsive" src="images/ce4.jpg" alt="img06">
						<figcaption>
							<h4 class="effect3">新加坡</h4>
							
						</figcaption>			
					</figure>
					</a>
				 </div>
				 </div>
				 <div class="col-md-6 grid-lo4">
				 	<div class=" grid-lo">
				 			<a href="buy_single.html">
					<figure class="effect-layla">
						<img class="img-responsive" src="images/ce5.jpg" alt="img06">
						<figcaption>
							<h4 class="effect3">巴黎</h4>
							
						</figcaption>			
					</figure>
					</a>
				 </div>
				 </div>
				 <div class="clearfix"> </div>
			</div>	
			</div>
			<div class="clearfix"> </div>
		</div>

	</div>
</div>
<!---->

<!--footer-->
<div class="footer">
	<div class="container">
		<div class="footer-top-at">
			<div class="col-md-3 amet-sed">
				<h4>Our Company</h4>
				<ul class="nav-bottom">
					<li><a href="about.html">About Us</a></li>
					<li><a href="blog.html">For Sale By Owner Blog</a></li>
					<li><a href="mobile_app.html">Mobile</a></li>
					<li><a href="terms.html">Terms & Conditions</a></li>
					<li><a href="privacy.html">Privacy Policy</a></li>	
					<li><a href="blog.html">Blog</a></li>
					
				</ul>	
			</div>
			<div class="col-md-3 amet-sed ">
				<h4>Work With Us</h4>
					<ul class="nav-bottom">
						<li><a href="single.html">Real Estate Brokers</a></li>
						<li><a href="single.html">Business Development</a></li>
						<li><a href="single.html">Affiliate Programs</a></li>
						<li><a href="contact.html">Sitemap</a></li>
						<li><a href="career.html">Careers</a></li>
						<li><a href="feedback.html">Feedback</a></li>	
					</ul>	
			</div>
			<div class="col-md-3 amet-sed">
				<h4>Customer Support</h4>
				<p>Mon-Fri, 7AM-7PM </p>
				<p>Sat-Sun, 8AM-5PM </p>
				<p>177-869-6559</p>
					<ul class="nav-bottom">
						<li><a href="#">Live Chat</a></li>
						<li><a href="faqs.html">Frequently Asked Questions</a></li>
						<li><a href="suggestion.html">Make a Suggestion</a></li>
					</ul>	
			</div>
			<div class="col-md-3 amet-sed ">
				<h4>Property Services</h4>
				   <ul class="nav-bottom">
						<li><a href="single.html">Residential Property</a></li>
						<li><a href="single.html">Commercial Property</a></li>
						<li><a href="login.html">Login</a></li>
						<li><a href="register.html">Register</a></li>
						<li><a href="typo.html">Short Codes</a></li>	
					</ul>	
					<ul class="social">
						<li><a href="#"><i> </i></a></li>
						<li><a href="#"><i class="gmail"> </i></a></li>
						<li><a href="#"><i class="twitter"> </i></a></li>
						<li><a href="#"><i class="camera"> </i></a></li>
						<li><a href="#"><i class="dribble"> </i></a></li>
					</ul>
			</div>
		<div class="clearfix"> </div>
		</div>
	</div>
</div>
<!--//footer-->

<script type="text/javascript">

var checkID = 0;

function getID(obj){
	checkID = obj.getAttribute("id");
}

$(document).ready(function () {

$('#searchBtn').click(function(){
	document.getElementById('promotionPlanList').innerHTML = "";
	
	if($('#province').val()==undefined||$('#city').val()==undefined||$('#startDate').val()==undefined){
		document.getElementById('infor').innerHTML='<div class="alert alert-danger" role="alert" style="text-align: center"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>您还没有将表单填写完整，请将表单填写完整!<a href="http://localhost:8080/web/home.html"><strong>   返回首页   </strong></a></div>';
	}
	else{
		// 促销计划
		$.ajax({
			url:"http://localhost:8080/HostelWorld/searchPromotionPlan",
			type:"POST",
			data:$("#search_form").serialize(),
			success:function(data){
				
				if(data=="fail"){
					document.getElementById('promotionPlanList').innerHTML='<div class="alert alert-danger" role="alert" style="text-align: center"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>暂时没有促销计划!<a href="http://localhost:8080/web/home.html"><strong>   返回首页   </strong></a></div>';
				}
				else{
					var temp = eval(data);
					var length = temp.length;
					
					var insertText = "<h3>以下酒店在选择的时间有优惠</h3>";
					for(var i=0; i<length; i++){
						insertText += "<a href='#' class='list-group-item' onclick='getID(this)' data-toggle='modal' data-target='#book' id=pro"+temp[i].hostelID+">"+
			 			"<h4 class='list-group-item-heading'>促销计划编号：<span>"+temp[i].promotionID+"</span></h4>"+
			 			"<label>促销计划名称：<span>"+temp[i].promotionName+"</span></label>"+"<p></p>"+
			 			"<label>酒店编号：<span>"+temp[i].hostelID+"</span></label>"+
			 			"<label style='margin-left: 30px'>酒店名称：<span>"+temp[i].hostelName+"</span></label>"+"<p></p>"+
			 			"<label >单间价格：<span>"+temp[i].singleFee+"</span></label>"+
			 			"<label style='margin-left: 78px'>标间价格：<span>"+temp[i].standardFee+"</span></label>"+
			 			"<label style='margin-left: 78px'>套间价格：<span>"+temp[i].suiteFee+"</span></label>"+"<p></p>"+
			 			"<label>开始日期：<span>"+temp[i].startDate+"</span></label>"+
			 			"<label style='margin-left: 25px'>结束日期：<span>"+temp[i].endDate+"</span></label>"+
			 		"</a>";
					}
					document.getElementById('promotionPlanList').innerHTML = insertText;
				}
		
			},
			"error":function(data){
				alert("Error");
			}
		});
		// 正常计划
		$.ajax({
			url:"http://localhost:8080/HostelWorld/searchOrdinaryPlan",
			type:"POST",
			data:$("#search_form").serialize(),
			success:function(data){
				
				if(data=="fail"){
					document.getElementById('ordinaryPlanList').innerHTML='<div class="alert alert-danger" role="alert" style="text-align: center"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>没有符合条件的酒店!<a href="http://localhost:8080/web/home.html"><strong>   返回首页   </strong></a></div>';
				}
				else{
					var temp = eval(data);
					var length = temp.length;
					
					var insertText = "<h3>以下酒店没有优惠，但是可以考虑选择哦！</h3>";
					for(var i=0; i<length; i++){
						insertText += "<a href='#' class='list-group-item' onclick='getID(this)' data-toggle='modal' data-target='#book' id=ord"+temp[i].hostelID+">"+
			 			"<h4 class='list-group-item-heading'>酒店编号：<span>"+temp[i].hostelID+"</span></h4>"+
			 			"<label style='margin-left: 30px'>酒店名称：<span>"+temp[i].hostelName+"</span></label>"+"<p></p>"+
			 			"<label >单间价格：<span>"+temp[i].singleFee+"</span></label>"+
			 			"<label style='margin-left: 78px'>标间价格：<span>"+temp[i].standardFee+"</span></label>"+
			 			"<label style='margin-left: 78px'>套间价格：<span>"+temp[i].suiteFee+"</span></label>"+"<p></p>"+
			 		"</a>";
					}
					document.getElementById('ordinaryPlanList').innerHTML = insertText;
				}
		
			},
			"error":function(data){
				alert("Error");
			}
		});
	}
});

});
$('#bookBtn').click(function(){
	var category = $('#category input[type=radio]:checked').val();
	var startDate = $('#startDate').val();
	var endDate = $('#endDate').val();
    $.ajax({
        url:"http://localhost:8080/HostelWorld/book",
        data:{"planID":checkID,"category":category,"startDate":startDate,"endDate":endDate},
        type:"get",
        success:function (data){
        	if(data=="success"){
	        	alert("预订成功");
	        	setTimeout('toSearch()',1000);
	        }
        	else if(data=="noAuth"){
		    	document.getElementById('infor').innerHTML='<div class="alert alert-danger" role="alert" style="text-align: center"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>您的会员卡没有激活，请激活后再来预订!<a href="http://localhost:8080/web/home.html"><strong>   返回首页   </strong></a></div>';
		    }
        	else{
		    	document.getElementById('infor').innerHTML='<div class="alert alert-danger" role="alert" style="text-align: center"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+data+'该日期的预订已经满了!<a href="http://localhost:8080/web/home.html"><strong>   返回首页   </strong></a></div>';
			}
        	//setTimeout('toSearch()',1000);
        }
    });
    
});


function toSearch(){
    window.location.href="/HostelWorld/home?id=14";
}
</script>
</body>
</html>